function FilterManager(){var l=this;var m=new Array();var n=$$('#tl_top_panel')[0];var o=$$('.tl_panel').getParent('form')[0];var p=new Array();l.init=function(){if(typeof o=='undefined'||o===null){$$('.add-filter').getParent().hide();return}var g=$$('.add-filter')[0];var h;o.getElements('.tl_subpanel').each(function(b){if(b.hasClass('tl_search')){b.getElements('div').destroy();b.inject(o,'top');if(typeof h!='undefined'){h.inject(o,'top')}return}else if(b.hasClass('tl_submit_panel')){b.getElement('.tl_img_submit').destroy();b.getElements('div').destroy();var c=new Element('button');var d=new Element('i');d.set('class','icon-large icon-refresh');d.inject(c);c.set('class','neuland_submit');c.inject(b,'bottom');h=b;return}var e=new s(b.getElement('strong'),g,o);e.init();var f=b.getElements('select');f.each(function(a){e.addNode(a)});e.render(o);p.push(e);delete(e)});o.getElements('.tl_panel').destroy();o.inject(n,'top');r()};var q=function(b,c,d){var f=new Element('li');var a=new Element('a');if(c){a.set('class',c)}if(d===null){d=function(e){e.stop();return false}}a.appendText(b);a.addEvent('click',d);a.inject(f);return f};var r=function(){var c=true;Object.each(m,function(a,b){if(a.length>0){c=false}});if(c){$$('.add-filter').getParent().getElement('.dropdown-toggle').removeEvents('click').addClass('disabled')}};var s=function(c,d,f){var g=this;var f=f;var h=c;var i=new Array();var j;var d=d;var k=null;g.init=function(){if(typeof m[g.getName()]=='undefined'){m[g.getName()]=new Array()}q(g.getName(),'group',null).inject(d)};g.getName=function(){return h.get('text')};this.addNode=function(a){m[g.getName()].push(a);if(!a.getElement('option[selected]')){q(a.getElement('option').get('text'),null,function(e){e.stop();g.showNode(a);g.render(f);this.getParent('.btn-group').removeClass('open');this.destroy();r()}).inject(d);return false}return g.showNode(a)};this.showNode=function(a){if(!m[g.getName()].contains(a)){return false}if(k==null){k=new Element('div');k.set('class','tl_subpanel');var b=new Element('strong');b.set('text',g.getName());b.inject(k)}a.show();a.inject(k);m[g.getName()].erase(a);return true};this.render=function(){if(k){k.inject(f)}n.getElements('.tl_subpanel div').destroy();Stylect.convertSelects()}}}document.addEvent('domready',function(){$$('.dropdown-toggle').addEvent('click',function(){var a=this.getParent();a.toggleClass('open');if(a.hasClass('open')){var b=this.getParent().getElement('ul');b.position({x:this.getCoordinates().right-b.getSize().x,y:this.getParent('#header').getCoordinates().bottom-5,})}});filter=new FilterManager();filter.init()});